# EscapeHint - Product Requirements Document (PRD)

## 문서 정보

| 항목            | 내용                                      |
| --------------- | ----------------------------------------- |
| **문서 버전**   | 1.1                                       |
| **작성일**      | 2025-11-26                                |
| **작성자**      | 윤인수                                    |
| **승인자**      | 윤인수                                    |
| **최종 수정일** | 2025-11-28                                |
| **관련 문서**   | [도메인 정의서](./1-domain-definition.md) |

---

## 1. Executive Summary

### 1.1 제품 개요

<!-- 도메인 정의서 1.1 비즈니스 목적 참조 -->

**한 줄 요약**: 방탈출 카페에서 플레이어들에게 실시간으로 힌트를 제공하는 웹 애플리케이션

**제품 설명**:

- 방탈출 카페에서 플레이어들에게 실시간으로 힌트를 제공하는 웹 애플리케이션

### 1.3 핵심 문제 정의

**현재 방탈출 카페가 겪는 문제**:

- 종이 힌트는 분실 위험이 있고 관리가 어렵다
- 직원 호출 방식은 플레이어의 몰입도를 저하시킨다

**도입 조건**:

- pc 또는 스마트폰 보유
- 안정적인 Wi-Fi 환경

---

## 2. Product Overview

### 2.1 핵심 가치 제안

<!-- 도메인 정의서 1.2 핵심 가치 참조 -->

**플레이어(Customer) 관점**:

- 직관적인 UI로 게임 몰입도 유지하면서 필요한 힌트 즉시 확인

**관리자(Admin) 관점**:

- 테마별 힌트 손쉬운 등록/수정
- 비공개 관리 인터페이스

**운영(Operations) 관점**:

- 게임 진행률 추적
- 힌트 사용 통계 확인

### 2.2 주요 기능 개요

1. **플레이어 기능**: 테마 선택 → 게임 시작 → 힌트 코드 입력 → 힌트/정답 확인
2. **관리자 기능**: 관리자 모드 진입 → 테마 관리 → 힌트 관리 → 세션 모니터링
3. **공통 기능**: 타이머, 진행률 표시, 세션 관리

---

## 3. User Personas

### 3.1 플레이어 페르소나

#### 페르소나 1: 초보 플레이어 "민수"

- **연령대**: 10~20대 중반
- **기대 경험**: 친구들과 즐거운 시간, 성취감
- **힌트 태도**: 막히면 빨리 힌트를 보고 싶어함
- **디지털 리터러시**: 높음, 스마트폰 앱 사용에 익숙
- **주요 니즈**: "게임 중 힌트를 빠르게 받아서 편하게 계속 진행하고 싶다"

#### 페르소나 2: 고급 플레이어 "지은"

- **연령대**: 20대 중반
- **방탈출 경험**: 20회 이상
- **기대 경험**: 은 난이도 도전, 스스로 해결
- **힌트 태도**: 최대한 힌트 안 보려 함
- **디지털 리터러시**: 높음
- **주요 니즈**: "힌트 없이 해결하되, 정말 필요할 때만 정확한 힌트를 받고 싶다"

### 3.2 관리자 페르소나

#### 페르소나 3: 카페 사장님 "현우"

- **역할**: 방탈출 카페 운영자
- **IT 숙련도**: 중간 (비전문가)
- **하루 평균 관리 시간**: 10분 이내 목표
- **주요 불편사항**: 종이 힌트 정리, 힌트 변경 어려움
- **주요 니즈**: "새 테마를 빠르게 등록하고, 고객 피드백에 따라 힌트를 쉽게 수정하고 싶다"

---

## 4. User Stories

### 4.1 플레이어 스토리

#### 필수 스토리 (P0)

- **US-01**: 플레이어로서, 테마를 선택하고 게임을 시작하여 타이머가 작동하는 것을 보고 싶다. 왜냐하면 제한 시간을 인지하고 긴장감을 느끼고 싶기 때문이다.

  - **참조**: 도메인 정의서 UC-01
  - **AC (Acceptance Criteria)**:
    - 활성화된 테마 목록이 표시됨
    - 테마 선택 시 게임 세션이 생성됨
    - 타이머가 자동으로 시작됨

- **US-02**: 플레이어로서, 힌트 코드를 빠르게 입력하고 힌트 내용을 확인하고 싶다. 왜냐하면 게임에 집중하고 싶기 때문이다.

  - **참조**: 도메인 정의서 UC-02
  - **AC**:
    - 코드 입력 후 엔터 또는 버튼 클릭으로 제출
    - 유효한 코드는 힌트 내용 + 진행률 + 정답보기 버튼 표시
    - 무효한 코드는 명확한 오류 메시지 표시

- **US-03**: 플레이어로서, 정답보기 버튼을 눌러 정답을 확인하고 싶다. 왜냐하면 힌트를 봐도 모르겠을 때 정답을 알고 넘어가고 싶기 때문이다.

  - **참조**: 도메인 정의서 UC-03
  - **AC**:
    - 버튼 클릭 시 정답 텍스트 표시
    - 정답은 명확하고 읽기 쉽게 표시

- **US-04**: 플레이어로서, 현재 플레이 정보(남은 시간, 사용한 힌트 수, 진행률)를 항상 확인하고 싶다. 왜냐하면 게임 진행 상황을 파악하고 싶기 때문이다.
  - **참조**: 도메인 정의서 UC-04
  - **AC**:
    - 타이머가 실시간으로 갱신됨
    - 사용한 힌트 수가 정확히 표시됨
    - 현재 진행률이 표시됨

#### 중요 스토리 (P1)

- [추가 스토리 작성]

### 4.2 관리자 스토리

#### 필수 스토리 (P0)

- **US-05**: 관리자로서, 비밀스럽게 관리자 모드에 진입하고 싶다. 왜냐하면 플레이어에게 노출되지 않아야 하기 때문이다.

  - **참조**: 도메인 정의서 UC-05
  - **AC**:
    - [작성 필요 - 진입 방법 결정 후] 예: 특정 영역 5회 탭 시 비밀번호 입력 화면 표시

- **US-06**: 관리자로서, 테마를 5분 안에 등록하고 싶다. 왜냐하면 바쁜 운영 시간에 빠르게 처리해야 하기 때문이다.

  - **참조**: 도메인 정의서 UC-06
  - **AC**:
    - 테마 이름, 설명, 제한시간 입력 후 저장
    - 중복 이름 검증
    - 활성화/비활성화 설정 가능

- **US-07**: 관리자로서, 힌트를 쉽게 등록하고 순서를 조정하고 싶다. 왜냐하면 힌트는 자주 수정되기 때문이다.
  - **참조**: 도메인 정의서 UC-07
  - **AC**:
    - 힌트 코드, 내용, 정답, 진행률 입력
    - [작성 필요 - 순서 조정 방법] 예: 드래그앤드롭
    - 힌트 활성화/비활성화 설정

#### 중요 스토리 (P1)

- **US-08**: 관리자로서, 진행 중인 게임 세션을 모니터링하고 싶다. 왜냐하면 고객 지원이 필요할 수 있기 때문이다.
  - **참조**: 도메인 정의서 UC-08
  - **AC**:
    - 진행 중인 세션 목록 조회
    - 세션별 사용 힌트 현황 확인
    - 세션 강제 종료 가능

---

## 5. Functional Requirements

### 5.1 기능별 우선순위

| 우선순위      | 기능                   | 설명                                 | 도메인 정의서 참조 |
| ------------- | ---------------------- | ------------------------------------ | ------------------ |
| **P0** (필수) | 테마 선택 및 게임 시작 | 플레이어가 테마를 선택하고 세션 시작 | UC-01              |
| **P0**        | 힌트 코드 입력 및 조회 | 코드 입력 시 힌트/정답 표시          | UC-02, UC-03       |
| **P0**        | 실시간 타이머          | 남은 시간 카운트다운                 | UC-04              |
| **P0**        | 테마 관리 (CRUD)       | 관리자가 테마 추가/수정/삭제         | UC-06              |
| **P0**        | 힌트 관리 (CRUD)       | 관리자가 힌트 추가/수정/삭제         | UC-07              |
| **P0**        | 관리자 인증            | 비밀스러운 관리자 모드 진입          | UC-05              |
| **P1** (중요) | 진행률 표시            | 힌트별 진행률 자동 계산 및 표시      | UC-02              |
| **P1**        | 세션 모니터링          | 진행 중인 세션 조회 및 관리          | UC-08              |
| **P1**        | 세션 복구              | 브라우저 새로고침 시 세션 유지       | BR-07              |
| **P2** (선택) | 통계 대시보드          | 테마별 힌트 사용 통계                | 5.5 확장 가능성    |
| **P2**        | 대량 힌트 등록         | CSV/엑셀 업로드로 힌트 일괄 등록     | [신규]             |

### 5.2 기능 상세 명세

#### F-01: 테마 선택 및 게임 시작 (P0)

- **설명**: 플레이어가 활성 테마 목록을 보고 선택하여 게임 세션을 시작
- **입력**: 테마 ID
- **출력**: 게임 세션 ID, 타이머 시작
- **비즈니스 규칙**: BR-03 (세션은 하나의 테마만 플레이)
- **예외 처리**:
  - 비활성 테마는 목록에 표시 안 함
  - 네트워크 오류 시 로컬 캐시 활용 (설계 필요)

#### F-02: 힌트 코드 입력 및 조회 (P0)

- **설명**: 플레이어가 힌트 코드를 입력하여 힌트 내용 확인
- **입력**: 힌트 코드 (대소문자 구분 없음)
- **출력**: 힌트 내용, 진행률, 정답보기 버튼
- **비즈니스 규칙**:
  - BR-01 (테마 내 코드 고유성)
  - BR-04 (동일 코드 재입력 시 카운트 증가 안 함)
  - BR-06 (코드 검증 실패 처리)
- **예외 처리**:
  - 존재하지 않는 코드: "힌트를 찾을 수 없습니다"
  - 비활성 힌트: "현재 사용할 수 없는 힌트입니다"
  - 다른 테마 코드: "현재 테마에서 사용할 수 없는 코드입니다"

[나머지 기능들도 동일한 형식으로 작성]

---

## 6. Non-Functional Requirements

### 6.1 성능 요구사항

<!-- 도메인 정의서 5.6 품질 속성 메트릭 참조 -->

| 메트릭              | 목표치      | 측정 방법                     |
| ------------------- | ----------- | ----------------------------- |
| API 응답 시간 (P95) | < 200ms     | APM 도구 모니터링             |
| 타이머 정확도       | ±500ms/60초 | 클라이언트-서버 동기화 테스트 |
| 동시 세션 처리      | 최대 20개   | 부하 테스트                   |
| 초기 로딩 시간      | < 3초       | Lighthouse 측정               |
| 최소 네트워크 환경  | 4G 이상     | 실제 환경 테스트              |

### 6.2 보안 요구사항

| 요구사항             | 상세                           | 구현 방법                           |
| -------------------- | ------------------------------ | ----------------------------------- |
| 통신 암호화          | HTTPS 필수                     | Vercel 자동 SSL/TLS 인증서          |
| XSS 방지             | 힌트 텍스트 이스케이프 처리    | DOMPurify 라이브러리                |
| 관리자 인증          | JWT 토큰 기반                  | Access Token (15분) + Refresh Token |
| 세션 보안            | 세션 하이재킹 방지             | HttpOnly 쿠키, Secure 플래그        |
| 데이터 암호화        | 정답 평문 저장 (암호화 불필요) | 민감 정보 아님으로 판단             |
| 관리자 세션 타임아웃 | 2시간                          | JWT 만료 시간 설정                  |

### 6.3 사용성 요구사항

<!-- 도메인 정의서 5.6 사용성 참조 -->

| 메트릭           | 목표치                                    |
| ---------------- | ----------------------------------------- |
| 고객 힌트 조회   | 3클릭 이내 (코드 입력 → 제출 → 힌트 표시) |
| 관리자 힌트 등록 | 5분 이내 (테마당 10개 힌트 기준)          |
| 모바일 터치 반응 | 100ms 이내 시각적 피드백                  |

### 6.4 신뢰성 요구사항

<!-- 도메인 정의서 5.6 신뢰성 참조 -->

| 메트릭                   | 목표치                           |
| ------------------------ | -------------------------------- |
| 세션 데이터 보존         | 브라우저 새로고침 시 100% 유지   |
| 타이머 백그라운드 정확도 | 탭 전환 후 복귀 시 ±2초 이내     |
| 데이터 손실률            | 0% (로컬 스토리지 + 서버 동기화) |
| 서버 가동률              | > 99.5% (Vercel 보장)            |

### 6.5 접근성 요구사항

| 항목           | 요구사항                                | 구현 여부          |
| -------------- | --------------------------------------- | ------------------ |
| 시각 장애 대응 | MVP에서는 미지원, 2차 버전 고려         | 2차 버전           |
| 색맹 대응      | 색상만으로 정보 전달 금지, 텍스트 병기  | 필수               |
| 터치 영역      | 최소 44x44px (모바일 터치 고려)         | 필수               |
| 키보드 접근성  | 힌트 입력 등 주요 기능 키보드 조작 가능 | 필수 (Enter 키 등) |

### 6.6 호환성 요구사항

| 항목        | 지원 범위                                      |
| ----------- | ---------------------------------------------- |
| 브라우저    | Chrome 90+, Safari 14+, Firefox 88+, Edge 90+  |
| 모바일 OS   | iOS 14+, Android 10+                           |
| 디바이스    | PC (데스크톱/노트북), 스마트폰(5인치 이상)     |
| 화면 해상도 | 최소 360x640px (모바일), 1024x768px (데스크톱) |

---

## 7. User Interface Requirements

### 7.1 플레이어 화면 UX 원칙

#### 디자인 원칙

- **몰입도 우선**: 게임 경험을 방해하지 않는 최소한의 UI
- **가독성**: 어두운 방에서도 읽기 쉬운 큰 글자
- **직관성**: 설명 없이도 사용 가능한 인터페이스

#### 구체적 요구사항

| 항목        | 요구사항                                                     | 결정 필요 여부 |
| ----------- | ------------------------------------------------------------ | -------------- |
| 글자 크기   | 본문 최소 18px, 제목 24px, 타이머 32px (어두운 방 가독성)    | 완료           |
| 색상 전략   | 라이트/다크 모드 지원 (기본 다크, 배경 #1a1a1a, 텍스트 #fff) | 완료           |
| 입력 방식   | 화면 키보드 + 물리 키보드 모두 지원, Enter 키 제출           | 완료           |
| 오류 메시지 | 명확하고 간결한 문구 (예: "힌트를 찾을 수 없습니다")         | 완료           |

### 7.2 관리자 화면 UX 원칙

#### 디자인 원칙

- **효율성**: 최소 클릭으로 작업 완료
- **명확성**: 현재 상태를 한눈에 파악 가능
- **실수 방지**: 중요한 작업은 확인 단계 추가

### 7.3 디바이스 및 환경

| 항목          | 상세                      |
| ------------- | ------------------------- |
| 주요 디바이스 | 1순위: pc, 2순위 스마트폰 |
| 환경 조건     | 어두운 방, 소음 환경      |

### 7.4 화면 구성 (Wireframe)

[와이어프레임 또는 목업 첨부 또는 링크]

**플레이어 주요 화면**:

1. 테마 선택 화면
2. 게임 화면 (타이머 + 힌트 입력 + 진행률)
3. 힌트 표시 화면

**관리자 주요 화면**:

1. 관리자 로그인
2. 대시보드
3. 테마 관리
4. 힌트 관리
5. 세션 모니터링

---

## 8. Technology Stack

### 8.1 기술 스택 개요

이 섹션에서는 프로젝트에서 사용할 구체적인 기술 스택을 정의합니다.

### 8.2 프론트엔드 (Frontend)

| 항목                | 선택 기술       | 버전 | 선택 이유                                               |
| ------------------- | --------------- | ---- | ------------------------------------------------------- |
| **프레임워크**      | React           | 18.x | 컴포넌트 재사용성, 풍부한 생태계, 빠른 개발 가능        |
| **언어**            | TypeScript      | 5.x  | 타입 안정성으로 런타임 에러 최소화, 개발 생산성 향상    |
| **상태 관리**       | Zustand         | 5.x  | 간단한 상태 관리, 보일러플레이트 최소화, 학습 곡선 낮음 |
| **스타일링**        | Tailwind CSS    | 3.x  | 빠른 UI 개발, 일관된 디자인 시스템, 다크모드 쉬운 구현  |
| **빌드 도구**       | Vite            | 5.x  | 빠른 개발 서버, HMR 지원, 최적화된 프로덕션 빌드        |
| **HTTP 클라이언트** | Axios           | 1.x  | 간편한 요청/응답 인터셉터, 에러 핸들링, 타입 지원       |
| **폼 관리**         | React Hook Form | 7.x  | 관리자 화면의 테마/힌트 등록 폼 검증 및 상태 관리       |
| **라우팅**          | React Router    | 6.x  | 플레이어/관리자 모드 분리, SPA 네비게이션               |

**추가 라이브러리**:

- **UI 컴포넌트**: Headless UI (드롭다운, 모달 등 접근성 높은 컴포넌트)
- **아이콘**: Lucide React (가벼운 아이콘 라이브러리)
- **날짜/시간**: date-fns (타이머 포맷팅 및 시간 계산)
- **로컬 스토리지**: localStorage API (세션 복구 및 오프라인 캐싱)
- **보안**: DOMPurify (힌트 텍스트 XSS 방지)
- **QR 코드**: qrcode.react (플레이어 접속 URL QR 생성, 선택)

### 8.3 백엔드 (Backend)

| 항목           | 선택 기술   | 버전     | 선택 이유                                                       |
| -------------- | ----------- | -------- | --------------------------------------------------------------- |
| **런타임**     | Node.js     | 20.x LTS | 높은 성능, 큰 생태계, 프론트엔드와 언어 공유로 개발 효율성 향상 |
| **언어**       | TypeScript  | 5.x      | 타입 안정성, 프론트엔드와 언어 통일, API 타입 공유 가능         |
| **프레임워크** | Express.js  | 4.x      | 간단하고 유연한 구조, 빠른 API 개발, 미들웨어 생태계 풍부       |
| **API 설계**   | RESTful API | -        | 표준화된 설계, 간단한 CRUD 구조에 적합                          |
| **인증/인가**  | JWT         | -        | 관리자 인증, stateless 방식으로 확장성 좋음                     |
| **검증**       | Zod         | 3.x      | TypeScript 우선 스키마 검증, 타입 추론 지원                     |
| **로깅**       | Winston     | 3.x      | 구조화된 로깅, 다양한 전송 방식 지원, 에러 추적                 |

**추가 라이브러리**:

- **ORM/Query Builder**: Prisma (타입 안전 쿼리, 마이그레이션 관리 편의)
- **환경 변수 관리**: dotenv (개발 환경 설정)
- **CORS**: cors 미들웨어 (프론트엔드-백엔드 통신 허용)
- **보안**: helmet (보안 헤더), bcrypt (관리자 비밀번호 해싱)
- **Rate Limiting**: express-rate-limit (API 남용 방지)

### 8.4 데이터베이스 (Database)

| 항목             | 선택 기술      | 버전 | 선택 이유                                              |
| ---------------- | -------------- | ---- | ------------------------------------------------------ |
| **RDBMS**        | PostgreSQL     | 16.x | 안정성, JSON 지원, 트랜잭션 처리, Supabase 완벽 호환   |
| **ORM**          | Prisma         | 5.x  | 타입 안전성, 마이그레이션 자동화, TypeScript 완벽 통합 |
| **마이그레이션** | Prisma Migrate | -    | 스키마 버전 관리, 자동 마이그레이션 생성, 롤백 지원    |
| **캐시 (선택)**  | 사용 안 함     | -    | MVP는 캐시 없이 단순화, 추후 Redis 도입 검토           |

**데이터베이스 설계 원칙**:

- 정규화: 3NF까지 적용 (테마-힌트 관계, 세션-힌트 사용 관계)
- 인덱싱 전략: themeId, hintCode, sessionId 등 자주 조회되는 컬럼에 인덱스
- 백업: Supabase 자동 백업 활용 (일일 백업, 7일 보관)

### 8.5 배포 및 인프라 (Deployment & Infrastructure)

| 항목                    | 선택 기술                | 선택 이유                                               |
| ----------------------- | ------------------------ | ------------------------------------------------------- |
| **호스팅**              | Vercel (프론트 + 백엔드) | 무료 티어, Git 연동 자동 배포, 서버리스 함수 지원       |
| **데이터베이스 호스팅** | Supabase                 | PostgreSQL 관리형 DB, 무료 티어 500MB, 실시간 기능 제공 |
| **환경**                | Development / Production | 개발/프로덕션 환경 분리, 환경변수 관리                  |
| **CI/CD**               | Vercel 자동 배포         | Git push 시 자동 빌드/배포, Preview 배포 지원           |
| **모니터링**            | Vercel Analytics (선택)  | 성능 모니터링, 에러 추적 (MVP는 기본 로깅으로 시작)     |

### 8.6 개발 도구 (Development Tools)

| 항목                  | 선택 기술         | 용도                                 |
| --------------------- | ----------------- | ------------------------------------ |
| **패키지 매니저**     | pnpm              | 빠른 설치 속도, 디스크 공간 효율적   |
| **버전 관리**         | Git + GitHub      | 소스 코드 관리, 이슈 추적            |
| **코드 포맷터**       | Prettier          | 일관된 코드 스타일 자동 적용         |
| **린터**              | ESLint            | 코드 품질 검사, TypeScript 규칙 적용 |
| **테스트 프레임워크** | Vitest (선택)     | Vite 네이티브 지원, 빠른 테스트 실행 |
| **E2E 테스트**        | Playwright (선택) | 플레이어/관리자 시나리오 통합 테스트 |
| **API 문서화**        | Postman (선택)    | API 테스트 및 명세 관리              |

### 8.7 아키텍처 다이어그램

```
┌─────────────────┐
│   플레이어 UI   │ (React + TypeScript + Tailwind)
│  (Vercel 배포)  │
└────────┬────────┘
         │ HTTPS
         │
┌────────▼────────┐
│  RESTful API    │ (Express/Fastify + TypeScript)
│ (Railway 배포)  │
└────────┬────────┘
         │
┌────────▼────────┐
│   PostgreSQL    │ (Supabase/Neon 호스팅)
│   (관리형 DB)   │
└─────────────────┘

[로컬 스토리지] ← 세션 복구용 (프론트엔드)
```

### 8.8 기술 선택 근거 요약

**왜 이 스택을 선택했는가?**

- **빠른 개발**: React + TypeScript + Tailwind 조합으로 빠른 프로토타이핑 및 UI 구현
- **타입 안전성**: 프론트엔드와 백엔드 모두 TypeScript 사용으로 런타임 에러 최소화
- **배포 간편성**: Vercel 풀스택 배포로 무료 호스팅 및 Git 연동 자동 배포
- **확장 가능성**: PostgreSQL + Prisma로 향후 데이터 구조 변경 및 관계 추가 용이
- **개발자 경험**: Vite, Zustand 등 최신 도구로 개발 생산성 극대화
- **비용 효율**: Vercel, Supabase 무료 티어로 초기 비용 없이 운영 가능

### 8.9 대안 기술 검토

프로젝트 특성에 따라 고려할 수 있는 대안:

| 선택지     | 대안             | 선택/제외 이유                                                                 |
| ---------- | ---------------- | ------------------------------------------------------------------------------ |
| React      | Vue.js / Svelte  | React 선택 - 더 큰 생태계, 많은 레퍼런스, Zustand 등 상태관리 도구 풍부        |
| Express    | Fastify / NestJS | Express 선택 - 간단한 CRUD API에 충분, 빠른 개발 가능, NestJS는 오버엔지니어링 |
| PostgreSQL | MySQL / SQLite   | PostgreSQL 선택 - Supabase 지원, JSON 타입 지원, 확장성                        |
| Vercel     | Netlify / AWS    | Vercel 선택 - 프론트/백엔드 통합 배포, 서버리스 함수 지원, 무료 티어 충분      |
| Zustand    | Redux / Recoil   | Zustand 선택 - 보일러플레이트 최소화, 간단한 상태에 적합, Redux는 복잡도 과다  |

### 8.10 기술 제약사항

| 제약사항                          | 영향                    | 대응 방안                             |
| --------------------------------- | ----------------------- | ------------------------------------- |
| Vercel 무료 티어 제한             | 동시 접속자 100명 제한  | 초기에는 충분, 확장 시 Pro 플랜 고려  |
| Supabase 무료 티어 DB 용량 500MB  | 장기 데이터 보관 제한   | 완료 세션 30일 후 자동 삭제           |
| 서버리스 함수 실행 시간 10초 제한 | 긴 처리 작업 불가       | 비동기 처리 또는 백그라운드 작업 검토 |
| Vercel 서버리스 함수 메모리 1GB   | 대용량 파일 처리 어려움 | 이미지 힌트는 외부 스토리지 사용      |

---

## 9. Business Rules

### 9.1 핵심 비즈니스 규칙

<!-- 도메인 정의서 4.1 비즈니스 규칙 참조 -->

도메인 정의서의 BR-01~BR-09를 그대로 적용. 추가 정책:

- **[BR-10]**: [추가 규칙 있으면 작성]

---

## 10. Data Requirements

### 10.1 주요 엔티티

<!-- 도메인 정의서 2.1 엔티티 정의 참조 -->

엔티티 상세는 도메인 정의서 참조. 추가 데이터 요구사항:

| 엔티티      | 데이터 보안 요구사항 | 백업 전략                         |
| ----------- | -------------------- | --------------------------------- |
| Theme       | 일반                 | Supabase 자동 백업 (일일)         |
| Hint        | 정답 필드 평문 저장  | Supabase 자동 백업 (일일)         |
| GameSession | 개인정보 없음        | 완료 후 30일 보관, 이후 자동 삭제 |

### 10.2 데이터 보존 정책

- **세션 데이터**: 완료 후 30일 보관, 이후 자동 삭제 (스토리지 절약)
- **통계 데이터**: 2차 버전에서 집계 데이터만 영구 보관 검토
- **백업**: Supabase 자동 일일 백업, 7일 보관 (무료 티어 기준)

---

## 11. Success Metrics

### 11.1 정량적 지표 (Quantitative Metrics)

#### 채택률 (Adoption)

- **3개월 목표**: 1개 카페 도입
- **6개월 목표**: 3개 카페 도입
- **1년 목표**: 10개 카페 도입
- **MAU (Monthly Active Users)**: 월 1,000명 플레이어

#### 사용성 지표

- **힌트 조회 성공률**: > 95% (오류 없이 힌트 조회 완료한 비율)
- **관리자 힌트 등록 완료율**: > 90% (등록 시작 후 완료한 비율)
- **평균 세션 에러율**: < 1%

#### 성능 지표

- **서버 가동률**: [작성 필요] 예: > 99.5%
- **평균 API 응답 시간**: < 150ms

### 11.2 정성적 지표 (Qualitative Metrics)

#### 사용자 만족도

- **NPS (Net Promoter Score)**: 목표 50+
- **플레이어 설문**: "힌트 시스템이 게임 경험을 방해하지 않았나?" → 긍정 80% 이상
- **관리자 설문**: "종이 힌트 대비 얼마나 편한가?" → "매우 편함" 70% 이상

### 11.3 비즈니스 지표

#### ROI (투자 대비 수익)

- **카페 입장**:직원 시간 절약 시간당 2회 힌트 제공 불필요 → 월 XX시간 절약
- **고객 만족도 향상**: 재방문율 20% 증가 목표

#### 확장성

- **테마당 평균 힌트 수**: 8-12개
- **카페당 평균 테마 수**: 3-5개

---

## 12. Assumptions & Constraints

### 12.1 기술적 제약사항

| 항목          | 제약 내용 | 영향                         |
| ------------- | --------- | ---------------------------- |
| 브라우저 지원 | 크롬 지원 | 일부 구형 디바이스 사용 불가 |

### 12.2 비즈니스 제약사항

| 항목        | 제약 내용                  |
| ----------- | -------------------------- |
| 개발 예산   | [작성 필요] 예: 0          |
| 운영 예산   | [작성 필요] 예: 0          |
| 출시 목표일 | [작성 필요] 예: 2025-11-28 |
| 개발팀 규모 | [작성 필요] 예: 1인 개발   |

### 12.3 가정 (Assumptions)

우리는 다음을 가정합니다:

1. 카페는 안정적인 Wi-Fi를 제공한다
2. 플레이어는 스마트폰 또는 설치된 PC를 사용한다
3. 관리자는 기본적인 웹 브라우저 사용법을 안다
4. 하나의 카페는 동시에 최대 5개 세션을 운영한다

---

## 13. Risks & Mitigation

### 13.1 기술적 위험

| 위험                            | 영향도 | 발생 가능성 | 완화 전략                                               |
| ------------------------------- | ------ | ----------- | ------------------------------------------------------- |
| 타이머 정확도 문제              | 높음   | 중간        | 서버 시간과 주기적 동기화 (60초마다)                    |
| 네트워크 단절 시 힌트 조회 실패 | 높음   | 낮음        | 힌트 데이터 로컬 캐싱 (세션 시작 시 전체 힌트 다운로드) |
| 예상보다 많은 동시 접속         | 중간   | 낮음        | [작성 필요] 예: 로드 밸런싱, 서버 스케일 아웃           |
| 브라우저 호환성 문제            | 중간   | 중간        | 지원 브라우저 명시, 구형 브라우저는 안내 메시지 표시    |

### 13.2 사용자 경험 위험

| 위험                                      | 영향도 | 발생 가능성 | 완화 전략                                                             |
| ----------------------------------------- | ------ | ----------- | --------------------------------------------------------------------- |
| 관리자 모드 노출 (플레이어가 우연히 발견) | 높음   | 낮음        | [작성 필요 - 진입 방법 결정 후] 예: 강력한 비밀번호 + IP 화이트리스트 |
| 힌트 코드 유출 (SNS 공유)                 | 중간   | 중간        | [작성 필요] 예: 코드 주기적 변경 기능 (2차 버전?) 또는 수용           |
| 디바이스 고장 (게임 중 태블릿 꺼짐)       | 높음   | 낮음        | 세션 복구 기능 필수 (로컬 스토리지 + 서버 동기화)                     |

### 13.3 비즈니스 위험

| 위험             | 영향도 | 발생 가능성 | 완화 전략                                        |
| ---------------- | ------ | ----------- | ------------------------------------------------ |
| 낮은 시장 채택률 | 높음   | 중간        | [작성 필요] 예: 무료 체험 기간, 파일럿 카페 운영 |
| 경쟁사 출현      | 중간   | 중간        | [작성 필요] 예: 차별화된 UX, 빠른 기능 추가      |

---

## 14. Release Plan & Roadmap

### 14.1 MVP (1차 출시) - [목표일: 2025-11-28]

#### 포함 기능 (P0)

- [x] 테마 선택 및 게임 시작
- [x] 힌트 코드 입력 및 조회
- [x] 정답 확인
- [x] 실시간 타이머
- [x] 플레이 정보 확인 (남은 시간, 사용 힌트 수, 진행률)
- [x] 관리자 모드 진입
- [x] 테마 관리 (CRUD)
- [x] 힌트 관리 (CRUD)

#### 제외 기능 (2차 이후)

- [ ] 세션 모니터링 (UC-08)
- [ ] 통계 대시보드
- [ ] 이미지/비디오 힌트
- [ ] 다국어 지원

### 14.2 Phase별 개발 계획

| Phase       | 기간 (예상) | 주요 기능                      | 완료 기준                         |
| ----------- | ----------- | ------------------------------ | --------------------------------- |
| **Phase 1** | 25.11.26.   | DB 스키마 설계 + 기본 API 개발 | API 테스트 통과                   |
| **Phase 2** | 25.11.26.   | 플레이어 화면 (힌트 조회) 개발 | 플레이어 시나리오 E2E 테스트 통과 |
| **Phase 3** | 25.11.27.   | 관리자 화면 개발               | 관리자 시나리오 E2E 테스트 통과   |
| **Phase 4** | 25.11.27.   | 타이머 및 세션 관리 고도화     | 타이머 정확도 테스트 통과         |
| **Phase 5** | 25.11.28.   | 통합 테스트 및 배포            | 프로덕션 배포 완료                |

---

## 15. Open Questions & Decisions Needed

### 15.1 해결 필요한 질문

아래 질문에 답변하여 PRD를 완성하세요:

#### 전략적 질문

- **Q1. 이 제품의 1년 후 구체적 목표는?**
  - 답변: 3개 이상 카페 도입, 사용자 만족도 NPS 50+
- **Q2. 경쟁 제품이 있는가? 있다면 차별점은?**
  - 답변: MVP에서는 고려 안 함, 소규모 카페 대상으로 단순화
- **Q3. 수익 모델은?**
  - 답변: MVP에서는 무료 제공, 추후 구독 모델 검토
- **Q4. MVP 범위는?**
  - 답변: 텍스트 힌트만 지원, 이미지 힌트는 2차 버전

#### 사용자 경험 질문

- **Q5. 플레이어의 주요 디바이스는?**
  - 답변: PC (카페 비치용), 개인 모바일 (2순위)
- **Q6. 관리자 모드 진입 방법은?**
  - 답변: 숨겨진 버튼 5회 클릭 → 비밀번호 입력
- **Q7. 힌트 코드 입력 방식은?**
  - 답변: 문제지에 인쇄된 숫자/문자 코드 직접 입력
- **Q8. 어두운 방에서 가독성 확보 방법은?**
  - 답변: 큰 글자 크기(18px+), 다크 모드, 높은 명도 대비

#### 기술적 질문

- **Q9. 배포 방식은?**
  - 답변: Vercel 풀스택 배포 (프론트+백엔드)
- **Q10. 오프라인 지원 수준은?**
  - 답변: 로컬 스토리지 캐싱으로 세션 복구, 완전 오프라인은 미지원
- **Q11. 지원 브라우저/OS 범위는?**
  - 답변: Chrome 90+, Safari 14+, Firefox 88+, Edge 90+
- **Q12. 데이터 백업 전략은?**
  - 답변: Supabase 자동 일일 백업, 7일 보관

#### 운영적 질문

- **Q13. 1차 출시 목표일은?**
  - 답변: 2025-11-28
- **Q14. 초기 설정 복잡도 허용 범위는?**
  - 답변: 카페 사장님이 1시간 내 테마/힌트 등록 가능해야 함
- **Q15. 사용자 지원 방식은?**
  - 답변: MVP에서는 이메일 지원, 추후 FAQ 추가

### 15.2 결정 사항 기록

결정이 완료되면 아래에 기록:

| 날짜       | 질문 번호 | 결정 내용                                     | 결정자 |
| ---------- | --------- | --------------------------------------------- | ------ |
| 2025-11-26 | Q1-Q15    | 모든 핵심 질문에 대한 답변 완료               | 윤인수 |
| 2025-11-26 | Q6        | 관리자 모드는 숨겨진 버튼 5회 클릭 + 비밀번호 | 윤인수 |
| 2025-11-26 | Q9        | Vercel 풀스택 배포로 결정                     | 윤인수 |
| 2025-11-26 | 기술스택  | React + TypeScript + Tailwind + Express 확정  | 윤인수 |

---

## 16. Appendix

### 16.1 참고 자료

- [도메인 정의서](./1-domain-definition.md)
- [작성 가이드](./polymorphic-marinating-willow.md)
- [기타 참고 자료]

### 16.2 용어 사전

<!-- 도메인 정의서 6장 용어 사전 참조 -->

| 용어      | 영문                   | 정의                                       |
| --------- | ---------------------- | ------------------------------------------ |
| 테마      | Theme                  | 방탈출 게임의 하나의 콘텐츠 단위           |
| 힌트      | Hint                   | 게임 진행을 돕기 위한 단서 정보            |
| 힌트 코드 | Hint Code              | 힌트에 접근하기 위해 입력하는 고유 코드    |
| 진행률    | Progress Rate          | 해당 힌트를 받았을 때의 게임 진행 정도 (%) |
| 세션      | Game Session           | 하나의 팀이 하나의 테마를 플레이하는 단위  |
| MVP       | Minimum Viable Product | 최소 기능 제품                             |
| P0/P1/P2  | Priority 0/1/2         | 기능 우선순위 (0: 필수, 1: 중요, 2: 선택)  |

### 16.3 변경 이력

| 버전 | 날짜       | 작성자 | 변경 내용                             | 승인자 |
| ---- | ---------- | ------ | ------------------------------------- | ------ |
| 1.0  | 2025-11-26 | 윤인수 | 초안 작성 (템플릿 기반)               | 윤인수 |
| 1.1  | 2025-11-26 | 윤인수 | 기술스택 전체 명세 완료               | 윤인수 |
| 1.2  | 2025-11-26 | 윤인수 | 비기능 요구사항, UI/UX 요구사항 완료  | 윤인수 |
| 1.3  | 2025-11-26 | 윤인수 | 핵심 질문 15개 답변 및 결정 사항 완료 | 윤인수 |

---
