# EscapeHint - User Scenario Document

## 문서 정보

| 항목            | 내용                                                         |
| --------------- | ------------------------------------------------------------ |
| **문서 버전**   | 1.1                                                          |
| **작성일**      | 2025-11-26                                                   |
| **작성자**      | Product Manager                                              |
| **승인자**      | 윤인수                                                       |
| **최종 수정일** | 2025-11-27                                                   |
| **문서 상태**   | 최종 승인 (와이어프레임 제거 및 실제 구현 반영)              |
| **관련 문서**   | [도메인 정의서](./1-domain-definition.md), [PRD](./3-prd.md) |

---

## 1. 개요 (Overview)

### 1.1 문서 목적

본 사용자 시나리오 문서는 EscapeHint 시스템의 실제 사용 흐름을 상세히 기술하여 다음 목적을 달성합니다:

- **개발팀**: 구현해야 할 인터랙션과 화면 전환을 구체적으로 이해
- **디자이너**: 각 단계별 UI/UX 요구사항과 사용자 피드백 시점 파악
- **QA 팀**: 테스트 시나리오 작성 및 예외 상황 검증 기준 확립
- **프로덕트 오너**: 실제 사용자 경험을 시뮬레이션하여 개선점 도출

### 1.2 시나리오 범위

본 문서는 다음 두 가지 주요 사용자 타입의 시나리오를 다룹니다:

1. **플레이어 시나리오**: 방탈출 게임을 플레이하는 고객

   - 게임 시작부터 힌트 확인, 정답 보기, 게임 종료까지 전체 여정
   - 정상 경로(Happy Path), 대체 경로(Alternative Path), 예외 경로(Error Path)

2. **관리자 시나리오**: 테마와 힌트를 관리하는 카페 운영자
   - 관리자 로그인부터 테마/힌트 등록, 세션 모니터링까지
   - 정상 경로, 대체 경로, 예외 경로

### 1.3 읽는 방법

각 시나리오는 다음 구조로 작성되었습니다:

- **사전 조건 (Preconditions)**: 시나리오 시작 전 만족해야 할 조건
- **주요 흐름 (Main Flow)**: 가장 일반적인 성공 경로
- **대체 흐름 (Alternative Flows)**: 사용자가 선택할 수 있는 다른 경로
- **예외 흐름 (Exception Flows)**: 오류 상황 및 처리 방법
- **사후 조건 (Postconditions)**: 시나리오 완료 후 시스템 상태


---

## 2. 플레이어 시나리오 (Player Scenarios)

### 2.1 시나리오 P1: 첫 방문 플레이어의 게임 시작 및 힌트 확인

#### 페르소나: 초보 플레이어 "민수" (10대 후반)

**상황**: 친구들과 방탈출 카페에 처음 방문. 직원으로부터 "힌트가 필요하면 태블릿에서 코드를 입력하세요"라는 간단한 안내를 받음. 게임 시작 20분 후 첫 번째 퍼즐에서 막혀 힌트가 필요한 상황.

---

#### 사전 조건 (Preconditions)

- 플레이어는 방탈출 방 안에 있음
- 태블릿 또는 스마트폰에서 EscapeHint 웹 앱에 접근 가능
- 카페 Wi-Fi에 연결되어 있음
- 아직 게임 세션을 시작하지 않은 상태

---

#### 주요 흐름 (Main Flow)

**Step 1: 웹 앱 접속**

- **사용자 행동**: 태블릿 화면에 고정된 URL(예: `https://escapehint.vercel.app`)을 터치하거나 QR 코드 스캔
- **시스템 반응**:
  - 로딩 스피너 표시 (최대 2초)
  - 테마 선택 화면으로 전환
- **화면 요소**:
  - 앱 로고 및 타이틀 "EscapeHint"
  - "테마를 선택하세요" 헤딩 (24px, bold)
  - 활성화된 테마 목록 (카드 레이아웃, 3~5개)
- **예상 소요 시간**: 3초


**Step 2: 테마 선택**

- **사용자 행동**: "좀비 연구소" 카드의 [시작하기] 버튼 터치
- **시스템 반응**:
  - 버튼이 눌린 시각적 피드백 (색상 변화, 100ms 이내)
  - "게임을 시작합니다..." 로딩 메시지 (1초)
  - 게임 세션 생성 (POST /api/sessions)
  - 세션 ID를 localStorage에 저장
  - 게임 화면으로 자동 전환
- **화면 전환 효과**: 부드러운 페이드 인/아웃 (200ms)
- **예상 소요 시간**: 2초

**Step 3: 게임 화면 진입**

- **시스템 반응**:
  - 타이머 자동 시작 (60:00부터 카운트다운)
  - 힌트 입력 필드 중앙에 포커스
- **화면 요소**:
  - **상단**:
    - 테마명: "좀비 연구소" (18px)
    - 타이머: "60:00" (32px, 빨간색 강조)
  - **중앙**:
    - 안내 텍스트: "힌트 코드를 입력하세요" (20px)
    - 입력 필드 (큰 텍스트, 자동 대문자 변환)
    - [확인] 버튼 (터치 영역 60x60px)
  - **하단**:
    - 진행률: "0%" (16px)
    - 사용 힌트: "0개" (16px)
- **예상 소요 시간**: 즉시


**Step 4: 게임 진행 (힌트 없이 20분 경과)**

- **사용자 행동**: 방 안에서 퍼즐을 풀며 게임 진행
- **시스템 반응**:
  - 타이머 실시간 카운트다운 (60:00 → 59:59 → ... → 40:00)
  - 백그라운드에서도 타이머 계속 작동 (탭 전환 시에도 유지)
  - 60초마다 서버 시간과 동기화하여 정확도 유지
- **화면 상태**: 대기 화면 유지 (힌트 입력 대기 중)
- **예상 소요 시간**: 20분

**Step 5: 첫 번째 힌트 코드 입력**

- **사용자 행동**:
  - 문제지에서 "HINT01" 코드 확인
  - 태블릿으로 돌아와 입력 필드에 "hint01" 타이핑 (대소문자 무관)
  - [확인] 버튼 터치 (또는 Enter 키 입력)
- **시스템 반응**:
  - 입력 코드를 자동으로 대문자 변환 ("hint01" → "HINT01")
  - 로딩 스피너 표시 (500ms)
  - 서버에 힌트 검증 요청 (POST /api/sessions/:id/hints)
  - 검증 성공 시 힌트 표시 화면으로 전환
- **예상 소요 시간**: 5초 (입력 3초 + 검증 2초)

**Step 6: 힌트 내용 확인**

- **시스템 반응**:
  - 힌트 내용 화면으로 전환 (페이드 인 효과)
  - 세션에 사용 힌트 기록
  - 진행률 자동 업데이트
- **화면 요소**:
  - **상단**: 타이머 계속 표시 (40:00)
  - **중앙**:
    - 힌트 제목: "힌트 #1" (20px, bold)
    - 힌트 내용: "거울 뒤를 확인하세요. 숨겨진 숫자가 있습니다." (24px, 여백 충분)
    - 진행률 표시: "15%" (진행 바 + 텍스트)
  - **하단**:
    - [정답보기] 버튼 (파란색, 44x150px)
    - [돌아가기] 버튼 (회색, 44x150px)
- **예상 소요 시간**: 10초 (읽기)


**Step 7: 정답 확인 (선택)**

- **사용자 행동**: [정답보기] 버튼 터치
- **시스템 반응**:
  - 확인 다이얼로그 표시: "정말 정답을 보시겠습니까? 한번 보면 돌이킬 수 없습니다."
  - [예] / [아니오] 버튼 제공
- **사용자 선택**: [예] 터치
- **시스템 반응**:
  - 정답 영역 표시 (힌트 내용 하단에 추가)
  - 정답 텍스트: "정답: 1234" (28px, 노란색 배경)
- **예상 소요 시간**: 3초


**Step 8: 게임 화면으로 복귀**

- **사용자 행동**: [돌아가기] 버튼 터치
- **시스템 반응**:
  - 게임 화면(Step 3)으로 전환
  - 업데이트된 진행률과 힌트 수 표시
  - 입력 필드 초기화 및 포커스
- **화면 상태**:
  - 진행률: "15%"
  - 사용 힌트: "1개"
- **예상 소요 시간**: 즉시

**Step 9: 추가 힌트 사용 (반복)**

- **사용자 행동**: 다시 퍼즐을 풀다가 "HINT02" 입력 → 힌트 확인 → 돌아가기
- **시스템 반응**: Step 5~8 반복
- **변경 사항**:
  - 진행률: 15% → 30% (힌트02의 진행률이 더 높은 경우)
  - 사용 힌트: 1개 → 2개

**Step 10: 게임 종료**

- **사용자 행동**:
  - 최종 퍼즐 해결 후 방 탈출 성공
  - 직원이 게임 종료 처리 또는 플레이어가 [게임 종료] 버튼 터치
- **시스템 반응**:
  - 완료 다이얼로그 표시
  - 세션 상태를 'completed'로 변경
  - 최종 통계 표시: "축하합니다! 사용 힌트: 3개, 소요 시간: 52분"
- **예상 소요 시간**: 5초


---

#### 사후 조건 (Postconditions)

- 게임 세션이 'completed' 상태로 저장됨
- 사용 힌트 코드 목록이 세션에 기록됨: ["HINT01", "HINT02", "HINT03"]
- 최종 진행률: 100%
- 종료 시간이 세션에 기록됨
- 플레이어는 새 게임을 시작하거나 앱을 종료할 수 있음

---

#### UI 인터랙션 가이드

| 화면 요소       | 인터랙션 타입 | 시각적 피드백       | 응답 시간 |
| --------------- | ------------- | ------------------- | --------- |
| 테마 카드       | 터치/클릭     | 배경색 변화 (hover) | < 100ms   |
| [시작하기] 버튼 | 터치/클릭     | 버튼 눌림 효과      | < 100ms   |
| 힌트 입력 필드  | 텍스트 입력   | 커서 깜빡임         | 즉시      |
| [확인] 버튼     | 터치/클릭     | 로딩 스피너 → 전환  | < 500ms   |
| [정답보기] 버튼 | 터치/클릭     | 확인 다이얼로그     | 즉시      |
| [돌아가기] 버튼 | 터치/클릭     | 페이드 아웃 → 전환  | < 200ms   |
| 타이머          | 자동 업데이트 | 숫자 변화 (1초마다) | 1초       |

---

### 2.2 시나리오 P2: 중간에 브라우저를 닫았다가 다시 접속 (세션 복구)

#### 페르소나: 고급 플레이어 "지은" (20대 중반)

**상황**: 게임 진행 중 실수로 태블릿 전원이 꺼짐. 30초 후 다시 켜서 웹 앱에 재접속.

---

#### 사전 조건 (Preconditions)

- 이미 게임 세션이 진행 중 (세션 ID가 localStorage에 저장됨)
- 타이머가 계속 작동 중 (서버 시간 기준)
- 2개의 힌트를 이미 사용함 (진행률 30%)

---

#### 주요 흐름 (Main Flow)

**Step 1: 웹 앱 재접속**

- **사용자 행동**: URL 재접속 또는 북마크 터치
- **시스템 반응**:
  - localStorage에서 세션 ID 확인
  - 세션 유효성 검증 (GET /api/sessions/:id)
  - 서버 시간 기준으로 남은 시간 계산
  - 게임 화면으로 직접 복귀 (테마 선택 화면 건너뜀)
- **화면 상태**:
  - 타이머: 서버 시간 기준으로 정확히 복구 (예: 35:42)
  - 진행률: 30% (기존 상태 유지)
  - 사용 힌트: 2개
- **알림 메시지**: "세션이 복구되었습니다." (3초간 표시 후 자동 사라짐)
- **예상 소요 시간**: 3초

**Step 2: 게임 계속 진행**

- **사용자 행동**: 다음 힌트 코드 입력 또는 퍼즐 계속 풀기
- **시스템 반응**: 시나리오 P1의 Step 5~10과 동일
- **예상 소요 시간**: 계속 진행

---

#### 사후 조건 (Postconditions)

- 세션 상태가 완전히 복구됨
- 타이머가 정확한 시간으로 계속 작동
- 이전에 사용한 힌트 목록이 유지됨
- 플레이어는 중단 없이 게임 계속 가능

---

#### 예외 처리

**예외 1: 세션이 만료된 경우 (2시간 초과)**

- **조건**: 마지막 활동 후 2시간 경과
- **시스템 반응**:
  - 알림: "세션이 만료되었습니다. 새 게임을 시작하세요."
  - 테마 선택 화면으로 리다이렉트
  - localStorage의 세션 ID 삭제

**예외 2: 네트워크 연결 실패**

- **조건**: Wi-Fi 연결 끊김
- **시스템 반응**:
  - 오류 메시지: "네트워크 연결을 확인하세요."
  - 로컬 데이터로 타이머는 계속 작동
  - 재연결 시 자동으로 서버와 동기화

---

### 2.3 시나리오 P3: 잘못된 힌트 코드 입력 (오류 처리)

#### 페르소나: 초보 플레이어 "민수"

**상황**: 문제지에 적힌 코드를 잘못 읽고 "HINT99" 입력 (존재하지 않는 코드)

---

#### 주요 흐름 (Main Flow)

**Step 1: 잘못된 코드 입력**

- **사용자 행동**: "HINT99" 입력 후 [확인] 버튼 터치
- **시스템 반응**:
  - 로딩 스피너 (500ms)
  - 서버 검증 결과: 404 Not Found
  - 오류 메시지 표시 (화면 상단에 빨간색 배너)
- **오류 메시지**: "❌ 힌트를 찾을 수 없습니다. 코드를 다시 확인하세요."
- **화면 상태**:
  - 입력 필드 유지 (값은 초기화)
  - 포커스 자동 복귀
  - 오류 메시지는 5초 후 자동 사라짐
- **예상 소요 시간**: 2초


**Step 2: 올바른 코드 재입력**

- **사용자 행동**: 문제지 다시 확인 후 "HINT01" 입력
- **시스템 반응**: 시나리오 P1 Step 5~6과 동일 (정상 흐름)

---

#### 대체 흐름 (Alternative Flows)

**대체 흐름 1: 비활성화된 힌트 코드 입력**

- **조건**: 관리자가 특정 힌트를 비활성화한 경우
- **오류 메시지**: "⚠️ 현재 사용할 수 없는 힌트입니다. 다른 코드를 시도하세요."

**대체 흐름 2: 다른 테마의 힌트 코드 입력**

- **조건**: "시간 여행자의 방" 테마 힌트 코드를 "좀비 연구소" 게임에서 입력
- **오류 메시지**: "❌ 현재 테마에서 사용할 수 없는 코드입니다."

**대체 흐름 3: 연속 5회 실패 (선택적 기능)**

- **조건**: 연속으로 5번 잘못된 코드 입력
- **시스템 반응**:
  - 오류 메시지: "⏳ 너무 많은 시도를 하셨습니다. 30초 후 다시 시도하세요."
  - [확인] 버튼 비활성화 (30초 카운트다운 표시)
  - 30초 후 자동 활성화

---

### 2.4 시나리오 P4: 동일한 힌트 코드 재입력 (중복 사용)

#### 페르소나: 고급 플레이어 "지은"

**상황**: 10분 전에 "HINT02" 힌트를 봤지만 내용을 잊어버려서 다시 확인하고 싶음.

---

#### 주요 흐름 (Main Flow)

**Step 1: 이미 사용한 코드 재입력**

- **사용자 행동**: "HINT02" 재입력 후 [확인]
- **시스템 반응**:
  - 서버 검증 성공 (이미 사용한 코드임을 확인)
  - 힌트 내용 화면으로 전환 (정상 흐름과 동일)
  - **중요**: 사용 힌트 수 증가하지 않음 (2개 유지)
- **알림 메시지**: "💡 이미 확인한 힌트입니다." (힌트 화면 상단에 3초간 표시)
- **화면 상태**:
  - 힌트 내용 정상 표시
  - 정답도 이미 확인했다면 자동으로 표시
  - 진행률 변화 없음
- **예상 소요 시간**: 2초

---

#### 사후 조건 (Postconditions)

- 사용 힌트 수 변화 없음 (카운트 증가 안 함)
- 세션의 사용 힌트 목록에 중복 추가되지 않음
- 플레이어는 자유롭게 이전 힌트 재확인 가능

---

### 2.5 시나리오 P5: 시간 초과 후에도 게임 계속 (타이머 음수 표시)

#### 페르소나: 초보 플레이어 "민수"

**상황**: 제한 시간 60분을 초과했지만 아직 게임을 완료하지 못함. 직원이 "조금 더 해보세요"라고 안내.

---

#### 주요 흐름 (Main Flow)

**Step 1: 제한 시간 도달**

- **시스템 반응**:
  - 타이머가 00:00에 도달
  - 알림 표시: "⏰ 제한 시간이 종료되었습니다!" (화면 중앙 오버레이)
  - [계속하기] / [게임 종료] 버튼 제공
- **화면 상태**: 게임 일시 정지 (힌트 입력 불가)


**Step 2: 게임 계속 선택**

- **사용자 행동**: [계속하기] 버튼 터치
- **시스템 반응**:
  - 오버레이 닫힘
  - 타이머가 음수로 계속 진행 (-00:01 → -00:02 → ...)
  - 타이머 색상 변경 (빨간색 → 주황색, 시간 초과 상태 시각적 표시)
  - 힌트 입력 계속 가능
- **예상 소요 시간**: 즉시

**Step 3: 음수 시간에도 게임 진행**

- **시스템 반응**:
  - 타이머 표시: "-02:34" (마이너스 2분 34초)
  - 힌트 사용 가능 (정상 흐름과 동일)
  - 세션 상태는 여전히 'in_progress'
- **사후 조건**:
  - 최종 완료 시 "제한시간 초과" 표시
  - 통계에서는 "실패" 또는 "제한시간 초과 완료"로 분류

---

## 3. 관리자 시나리오 (Admin Scenarios)

### 3.1 시나리오 A1: 관리자 모드 진입 및 새 테마 등록

#### 페르소나: 카페 사장님 "현우" (30대, IT 중급)

**상황**: 새로운 방탈출 테마 "해적선의 보물"을 오픈하기로 결정. 테마와 힌트 10개를 시스템에 등록하고 싶음. 업무 시작 전 오전에 작업.

---

#### 사전 조건 (Preconditions)

- 관리자는 PC 또는 태블릿에서 EscapeHint 웹 앱에 접근
- 플레이어 화면이 표시되고 있음 (테마 선택 화면)
- 관리자 비밀번호를 알고 있음

---

#### 주요 흐름 (Main Flow)

**Step 1: 관리자 로그인 페이지 접속**

- **사용자 행동**:
  - 브라우저 주소창에 `/admin/login` URL 직접 입력 (예: `https://escapehint.vercel.app/admin/login`)
  - 또는 북마크에 저장된 관리자 로그인 링크 클릭
- **시스템 반응**:
  - 관리자 로그인 화면으로 전환
  - 로그인 폼 표시
- **화면 요소**:
  - 페이지 제목: "관리자 로그인"
  - 비밀번호 입력 필드 (password 타입)
  - [로그인] 버튼
- **예상 소요 시간**: 2초


**Step 2: 비밀번호 입력 및 인증**

- **사용자 행동**: 비밀번호 입력 후 [로그인] 버튼 클릭
- **시스템 반응**:
  - 로딩 스피너 표시 (500ms)
  - 서버 인증 (POST /api/admin/auth/login)
  - JWT 토큰 발급 및 localStorage에 저장
  - 관리자 대시보드로 리다이렉트 (/admin/dashboard)
- **예상 소요 시간**: 2초

**Step 3: 관리자 대시보드 진입**

- **시스템 반응**:
  - 관리자 전용 레이아웃 표시
  - 좌측 네비게이션 메뉴 표시
  - 우측 메인 컨텐츠 영역에 대시보드 통계 표시
- **화면 요소**:
  - **좌측 네비게이션**:
    - [대시보드] (현재 활성)
    - [테마 관리]
    - [힌트 관리]
    - [세션 모니터링]
    - [로그아웃]
  - **우측 메인 컨텐츠**:
    - 전체 테마 수: 3개
    - 진행 중인 세션: 2개
    - 오늘의 힌트 사용: 15회
    - 최근 활동 로그 (테이블)
- **예상 소요 시간**: 1초


**Step 4: 테마 관리 화면 진입**

- **사용자 행동**: 좌측 네비게이션에서 [테마 관리] 클릭
- **시스템 반응**:
  - 테마 목록 화면으로 전환
  - 기존 테마 목록 표시 (테이블 형태)
- **화면 요소**:
  - **상단**: [+ 새 테마 등록] 버튼 (파란색, 우측 상단)
  - **테이블 헤더**: 이름 | 제한시간 | 힌트 수 | 활성 | 작업
  - **테이블 데이터**:
    - 좀비 연구소 | 60분 | 12개 | 🟢 활성 | [수정] [삭제]
    - 시간 여행자의 방 | 90분 | 8개 | 🟢 활성 | [수정] [삭제]
    - 마법사의 탑 | 75분 | 10개 | 🔴 비활성 | [수정] [삭제]
- **예상 소요 시간**: 1초

**Step 5: 새 테마 등록 폼 열기**

- **사용자 행동**: [+ 새 테마 등록] 버튼 클릭
- **시스템 반응**:
  - 테마 등록 폼 모달 또는 새 페이지로 표시
  - 빈 폼 필드 제공
- **화면 요소**:
  - **테마 이름**: 텍스트 입력 (필수, 1-50자)
  - **테마 설명**: 텍스트 영역 (선택, 최대 200자)
  - **제한 시간**: 숫자 입력 (필수, 10-180분)
  - **활성화 여부**: 토글 스위치 (기본 ON)
  - **버튼**: [저장] / [취소]
- **예상 소요 시간**: 즉시


**Step 6: 테마 정보 입력**

- **사용자 행동**:
  - 테마 이름: "해적선의 보물"
  - 설명: "해적선에서 숨겨진 보물을 찾아라!"
  - 제한 시간: 60분
  - 활성화: ON
  - [저장] 버튼 클릭
- **시스템 반응**:
  - 클라이언트 측 검증 (빈 필드, 제한시간 범위 등)
  - 검증 성공 시 서버 전송 (POST /api/admin/themes)
  - 로딩 스피너 (500ms)
  - 서버 검증 (중복 이름 체크 등)
  - 성공 시 테마 목록 화면으로 복귀
  - 성공 메시지 표시: "✅ 테마가 등록되었습니다."
- **예상 소요 시간**: 1분 (입력 50초 + 저장 10초)

**Step 7: 등록된 테마 확인**

- **시스템 반응**:
  - 테마 목록에 새 항목 추가 (테이블 최상단)
  - 해적선의 보물 | 60분 | 0개 | 🟢 활성 | [수정] [삭제] [힌트 관리]
- **화면 상태**:
  - 성공 메시지 3초 후 자동 사라짐
  - 포커스는 새로 등록된 테마 행으로 이동
- **예상 소요 시간**: 즉시

---

#### 사후 조건 (Postconditions)

- 새 테마 "해적선의 보물"이 DB에 저장됨
- 테마 ID가 자동 생성됨
- 활성화 상태로 설정됨
- 플레이어 화면의 테마 목록에 즉시 표시됨 (활성 상태이므로)
- 아직 힌트가 없으므로 힌트 수는 0개

---

### 3.2 시나리오 A2: 등록한 테마에 힌트 추가 (10개)

#### 페르소나: 카페 사장님 "현우"

**상황**: 방금 등록한 "해적선의 보물" 테마에 힌트 10개를 추가하고 싶음. 미리 준비한 엑셀 파일에 힌트 내용이 정리되어 있음.

---

#### 사전 조건 (Preconditions)

- 테마 "해적선의 보물"이 등록되어 있음
- 관리자는 테마 관리 화면에 있음
- 힌트 내용이 준비되어 있음 (코드, 내용, 정답, 진행률)

---

#### 주요 흐름 (Main Flow)

**Step 1: 힌트 관리 화면 진입**

- **사용자 행동**: 테마 목록에서 "해적선의 보물" 행의 [힌트 관리] 버튼 클릭
- **시스템 반응**:
  - 힌트 목록 화면으로 전환
  - 현재 테마명 표시: "해적선의 보물 - 힌트 관리"
  - 빈 힌트 목록 표시 (아직 등록된 힌트 없음)
- **화면 요소**:
  - **상단**: [← 테마 목록으로] 버튼 (좌측), [+ 새 힌트 등록] 버튼 (우측)
  - **안내 메시지**: "등록된 힌트가 없습니다. 첫 힌트를 추가하세요."
- **예상 소요 시간**: 1초

**Step 2: 첫 번째 힌트 등록 폼 열기**

- **사용자 행동**: [+ 새 힌트 등록] 버튼 클릭
- **시스템 반응**:
  - 힌트 등록 폼 모달 표시
  - 빈 폼 필드 제공
- **화면 요소**:
  - **힌트 코드**: 텍스트 입력 (필수, 2-20자, 영숫자+하이픈)
  - **힌트 내용**: 텍스트 영역 (필수, 1-500자)
  - **정답**: 텍스트 영역 (필수, 1-200자)
  - **진행률**: 숫자 입력 (필수, 0-100%)
  - **순서**: 자동 입력 (1로 시작)
  - **활성화 여부**: 토글 스위치 (기본 ON)
  - **버튼**: [저장] / [저장 후 다음] / [취소]
- **예상 소요 시간**: 즉시


**Step 3: 첫 번째 힌트 정보 입력 및 저장**

- **사용자 행동**:
  - 힌트 코드: "HINT01"
  - 힌트 내용: "선장의 방에서 나침반을 찾으세요."
  - 정답: "나침반은 책장 뒤에 있습니다."
  - 진행률: 10%
  - 활성화: ON
  - [저장 후 다음] 버튼 클릭
- **시스템 반응**:
  - 클라이언트 검증 (필수 필드, 진행률 범위)
  - 서버 전송 (POST /api/admin/hints/themes/:themeId/hints)
  - 서버 검증 (힌트 코드 중복 체크)
  - 저장 성공 시 폼 초기화 (순서는 2로 자동 증가)
  - 성공 메시지: "✅ 힌트가 저장되었습니다. (1/10)"
- **예상 소요 시간**: 30초 (입력 25초 + 저장 5초)

**Step 4: 나머지 힌트 연속 등록 (2~10번)**

- **사용자 행동**: Step 3을 9번 반복
  - HINT02, HINT03, ..., HINT10
  - 진행률: 10%, 20%, 30%, ..., 100%
  - 마지막 힌트는 [저장] 버튼 클릭 (폼 닫힘)
- **시스템 반응**:
  - 각 힌트마다 순서 자동 증가 (2, 3, ..., 10)
  - 성공 메시지: "✅ 힌트가 저장되었습니다. (2/10)", ..., "✅ 힌트가 저장되었습니다. (10/10)"
  - 10번째 힌트 저장 후 폼 자동 닫힘
- **예상 소요 시간**: 4분 30초 (30초 × 9회)

**Step 5: 등록된 힌트 목록 확인**

- **시스템 반응**:
  - 힌트 목록 테이블 표시 (10개 행)
  - 드래그앤드롭으로 순서 조정 가능
- **화면 요소**:
  - **테이블 헤더**: ↕ 순서 | 코드 | 내용 미리보기 | 진행률 | 활성 | 작업
  - **테이블 데이터**:
    - 1 | HINT01 | 선장의 방에서... | 10% | 🟢 | [수정] [삭제]
    - 2 | HINT02 | 갑판 위의... | 20% | 🟢 | [수정] [삭제]
    - ...
    - 10 | HINT10 | 최종 보물상자... | 100% | 🟢 | [수정] [삭제]
- **예상 소요 시간**: 즉시


**Step 6: 힌트 순서 조정 (선택)**

- **사용자 행동**:
  - HINT03 행을 드래그하여 HINT02 위로 이동 (순서 변경)
- **시스템 반응**:
  - 시각적 피드백 (드래그 중 행 반투명 표시)
  - 드롭 시 순서 자동 재정렬 (2 ↔ 3 교환)
  - 서버에 순서 업데이트 (PATCH /api/admin/hints/hints/:id/order)
  - 성공 메시지: "✅ 순서가 변경되었습니다."
- **예상 소요 시간**: 5초

---

#### 사후 조건 (Postconditions)

- 테마 "해적선의 보물"에 힌트 10개가 등록됨
- 각 힌트는 고유한 코드(HINT01~HINT10)를 가짐
- 진행률은 10%~100%로 분산됨
- 모든 힌트가 활성화 상태
- 플레이어가 해당 테마를 선택하면 힌트 사용 가능
- 테마 목록에서 "힌트 수: 10개"로 표시됨

---

#### 대체 흐름 (Alternative Flows)

**대체 흐름 1: CSV 대량 등록 (2차 버전)**

- **조건**: 힌트가 20개 이상으로 많은 경우
- **화면 요소**: [CSV 업로드] 버튼 제공
- **사용자 행동**: CSV 파일 선택 → [업로드]
- **시스템 반응**:
  - CSV 파싱 및 검증
  - 일괄 등록 (POST /api/admin/hints/bulk)
  - 성공/실패 결과 표시

**대체 흐름 2: 힌트 미리보기**

- **조건**: 힌트 등록 후 플레이어 화면에서 어떻게 보이는지 확인하고 싶음
- **화면 요소**: 각 힌트 행에 [미리보기] 버튼
- **사용자 행동**: [미리보기] 클릭
- **시스템 반응**:
  - 플레이어 화면 시뮬레이션 모달 표시
  - 힌트 내용 + 진행률 + 정답 표시 (플레이어 UI와 동일)

---

### 3.3 시나리오 A3: 힌트 내용 수정 (고객 피드백 반영)

#### 페르소나: 카페 사장님 "현우"

**상황**: 고객으로부터 "HINT05가 너무 어렵다"는 피드백을 받음. 힌트 내용을 좀 더 쉽게 수정하고 싶음.

---

#### 주요 흐름 (Main Flow)

**Step 1: 힌트 관리 화면에서 수정 대상 선택**

- **사용자 행동**:
  - 테마 "해적선의 보물" 힌트 관리 화면 진입
  - HINT05 행의 [수정] 버튼 클릭
- **시스템 반응**:
  - 힌트 수정 폼 모달 표시
  - 기존 데이터 자동 로드
- **화면 요소**:
  - 폼 필드는 등록 시와 동일하지만 기존 값으로 채워짐
  - 버튼: [저장] / [취소]
- **예상 소요 시간**: 2초

**Step 2: 힌트 내용 수정**

- **사용자 행동**:
  - 기존 내용: "선실의 비밀 서랍을 열어보세요."
  - 수정 내용: "선실 침대 옆 서랍에 숫자 자물쇠가 있습니다. 비밀번호는 4자리입니다."
  - [저장] 버튼 클릭
- **시스템 반응**:
  - 서버 전송 (PUT /api/admin/hints/hints/:id)
  - 저장 성공 시 폼 닫힘
  - 성공 메시지: "✅ 힌트가 수정되었습니다."
  - 힌트 목록에서 내용 미리보기 자동 업데이트
- **예상 소요 시간**: 30초

---

#### 사후 조건 (Postconditions)

- HINT05의 내용이 변경됨
- 기존에 진행 중인 세션에는 즉시 반영되지 않음 (캐시 유지)
- 새로 시작하는 세션에서는 수정된 내용 표시
- updatedAt 타임스탬프 자동 갱신

---

### 3.4 시나리오 A4: 진행 중인 게임 세션 모니터링 (2차 버전)

#### 페르소나: 카페 사장님 "현우"

**상황**: 오후 성수기 시간에 3개 방에서 동시에 게임이 진행 중. 각 방의 진행 상황을 확인하고 싶음.

---

#### 주요 흐름 (Main Flow)

**Step 1: 세션 모니터링 화면 진입**

- **사용자 행동**: 좌측 네비게이션에서 [세션 모니터링] 클릭
- **시스템 반응**:
  - 세션 목록 화면으로 전환
  - 진행 중인 세션 실시간 표시
- **화면 요소**:
  - **필터**: [전체] / [진행중] / [완료] / [중단]
  - **세션 카드** (각 세션당):
    - 테마명: 좀비 연구소
    - 시작 시간: 14:30
    - 경과 시간: 35분 (남은 시간: 25분)
    - 사용 힌트: 3개 (HINT01, HINT02, HINT05)
    - 진행률: 45%
    - [상세 보기] / [강제 종료] 버튼
- **자동 갱신**: 10초마다 자동 리프레시
- **예상 소요 시간**: 1초


**Step 2: 세션 상세 보기**

- **사용자 행동**: 첫 번째 세션("좀비 연구소")의 [상세보기] 클릭
- **시스템 반응**:
  - 세션 상세 정보 모달 표시
- **화면 요소**:
  - **세션 정보**:
    - 세션 ID: #12345
    - 테마: 좀비 연구소
    - 시작 시간: 2025-11-26 14:30:00
    - 경과 시간: 35분 12초
  - **힌트 사용 내역** (타임라인):
    - 14:40 - HINT01 (진행률 10%)
    - 14:55 - HINT02 (진행률 25%)
    - 15:00 - HINT05 (진행률 45%)
  - **버튼**: [강제 종료] / [닫기]
- **예상 소요 시간**: 1초

**Step 3: 세션 강제 종료 (필요 시)**

- **사용자 행동**: [강제 종료] 버튼 클릭
- **시스템 반응**:
  - 확인 다이얼로그: "세션을 강제 종료하시겠습니까? 이 작업은 되돌릴 수 없습니다."
  - [확인] / [취소] 버튼
- **사용자 선택**: [확인]
- **시스템 반응**:
  - 세션 상태를 'aborted'로 변경
  - 세션 목록에서 "중단" 탭으로 이동
  - 플레이어 화면에는 "세션이 종료되었습니다" 메시지 표시
- **예상 소요 시간**: 3초

---

#### 사후 조건 (Postconditions)

- 관리자는 모든 진행 중인 세션을 실시간으로 모니터링 가능
- 필요 시 세션 강제 종료하여 비정상 세션 처리 가능
- 세션 데이터는 완료 후 30일 보관

---

### 3.5 시나리오 A5: 관리자 로그아웃

#### 페르소나: 카페 사장님 "현우"

**상황**: 작업을 마치고 관리자 모드에서 로그아웃하고 싶음.

---

#### 주요 흐름 (Main Flow)

**Step 1: 로그아웃 버튼 클릭**

- **사용자 행동**: 좌측 네비게이션 하단의 [로그아웃] 버튼 클릭
- **시스템 반응**:
  - 확인 다이얼로그: "로그아웃하시겠습니까?"
  - [확인] / [취소] 버튼
- **예상 소요 시간**: 1초

**Step 2: 로그아웃 확인**

- **사용자 행동**: [확인] 버튼 클릭
- **시스템 반응**:
  - 서버에 로그아웃 요청 (POST /api/admin/auth/logout)
  - JWT 토큰 쿠키 삭제
  - 로컬 스토리지 관리자 데이터 삭제
  - 플레이어 화면(테마 선택)으로 리다이렉트
- **알림 메시지**: "👋 로그아웃되었습니다."
- **예상 소요 시간**: 2초

---

#### 사후 조건 (Postconditions)

- 관리자 세션 종료
- JWT 토큰 무효화
- 플레이어 화면으로 복귀
- 관리자 화면 재접속 시 다시 로그인 필요

---

## 4. 예외 상황 처리 (Exception Handling)

### 4.1 플레이어 예외 시나리오

#### E-P1: 네트워크 연결 끊김 (게임 진행 중)

**상황**: Wi-Fi 연결이 불안정하여 힌트 조회 API 요청 실패

**처리 방법**:

- **즉시 반응**:
  - 오류 메시지: "⚠️ 네트워크 연결을 확인하세요."
  - 로컬 캐시 데이터로 계속 작동 (타이머, 진행률 표시)
- **재연결 시**:
  - 자동으로 서버와 동기화
  - 누락된 힌트 사용 기록 서버에 전송
  - "✅ 연결이 복구되었습니다." 메시지


---

#### E-P2: 브라우저 캐시/쿠키 삭제 (세션 ID 손실)

**상황**: 플레이어가 브라우저 캐시를 삭제하여 localStorage의 세션 ID 손실

**처리 방법**:

- **시스템 반응**:
  - 세션 ID를 찾을 수 없음
  - 안내 메시지: "이전 세션을 찾을 수 없습니다. 새 게임을 시작하세요."
  - 테마 선택 화면으로 이동
- **복구 불가**: 세션 데이터는 서버에만 저장되므로 완전 복구 불가능
- **대안**: 세션 ID를 URL 파라미터로도 관리 (2차 버전 검토)

---

#### E-P3: 시스템 점검 중 접속

**상황**: 서버 점검 시간에 플레이어가 웹 앱 접속

**처리 방법**:

- **시스템 반응**:
  - 점검 중 화면 표시
  - 점검 종료 예정 시간 안내
  - 자동 새로고침 버튼 제공


---

### 4.2 관리자 예외 시나리오

#### E-A1: 중복 테마 이름 등록 시도

**상황**: "좀비 연구소" 테마가 이미 존재하는데 같은 이름으로 등록 시도

**처리 방법**:

- **클라이언트 검증** (실시간):
  - 테마 이름 입력 중 실시간으로 중복 체크 (debounce 500ms)
  - 중복 시 입력 필드 하단에 경고 표시: "⚠️ 이미 존재하는 테마 이름입니다."
  - [저장] 버튼 비활성화
- **서버 검증**:
  - 혹시 클라이언트 검증을 우회한 경우 서버에서 재검증
  - 409 Conflict 응답 반환
  - 오류 메시지: "이미 존재하는 테마 이름입니다. 다른 이름을 사용하세요."

---

#### E-A2: 진행 중인 세션이 있는 테마 삭제 시도

**상황**: "좀비 연구소" 테마를 삭제하려 하는데 현재 2개 세션이 진행 중

**처리 방법**:

- **클라이언트 검증**:
  - [삭제] 버튼 클릭 시 서버에 세션 존재 여부 확인
- **경고 다이얼로그**:
  - 제목: "⚠️ 테마를 삭제할 수 없습니다"
  - 내용: "현재 2개의 게임 세션이 진행 중입니다. 모든 세션이 종료된 후 삭제하세요."
  - 옵션 1: [세션 종료 후 삭제] (세션 강제 종료 → 테마 삭제)
  - 옵션 2: [취소]
- **안전 장치**: 관리자가 강제 종료를 선택해야만 삭제 가능

---

#### E-A3: 관리자 세션 만료 (2시간 초과)

**상황**: 관리자 화면을 2시간 이상 방치하여 JWT 토큰 만료

**처리 방법**:

- **자동 갱신 시도**:
  - Refresh Token으로 자동 갱신 시도
  - 성공 시 무중단 계속 사용
- **갱신 실패 시**:
  - 알림: "세션이 만료되었습니다. 다시 로그인하세요."
  - 관리자 로그인 화면으로 리다이렉트
  - 작업 중이던 데이터는 localStorage에 임시 저장 (복구 가능)

---

#### E-A4: 관리자 비밀번호 3회 이상 실패

**상황**: 관리자 로그인 시 비밀번호를 3회 연속 틀림

**처리 방법**:

- **시스템 반응**:
  - 오류 메시지: "⚠️ 비밀번호를 3회 틀렸습니다. 5분 후 다시 시도하세요."
  - 로그인 폼 비활성화 (5분 카운트다운 표시)
  - IP 주소 기준으로 제한 (Rate Limiting)
- **5분 후**:
  - 자동으로 폼 활성화
  - 다시 3회 기회 부여
- **보안 로그**: 실패한 로그인 시도는 서버에 기록

---

## 5. 시나리오 매핑 테이블

### 5.1 플레이어 시나리오 vs 도메인 유스케이스

| 시나리오 ID | 시나리오 제목              | 도메인 UC         | PRD User Story    | 우선순위 |
| ----------- | -------------------------- | ----------------- | ----------------- | -------- |
| P1          | 첫 방문 플레이어 게임 진행 | UC-01, 02, 03, 04 | US-01, 02, 03, 04 | P0       |
| P2          | 세션 복구                  | UC-01 (복구)      | US-04-1           | P1       |
| P3          | 잘못된 힌트 코드 입력      | UC-02 (예외)      | US-02 (AC)        | P0       |
| P4          | 동일 힌트 재입력           | UC-02 (중복)      | BR-04             | P0       |
| P5          | 시간 초과 후 게임 계속     | UC-04 (예외)      | BR-03             | P1       |

### 5.2 관리자 시나리오 vs 도메인 유스케이스

| 시나리오 ID | 시나리오 제목              | 도메인 UC    | PRD User Story | 우선순위 |
| ----------- | -------------------------- | ------------ | -------------- | -------- |
| A1          | 관리자 로그인 및 테마 등록 | UC-05, 06    | US-05, 06      | P0       |
| A2          | 힌트 추가 (10개)           | UC-07        | US-07          | P0       |
| A3          | 힌트 내용 수정             | UC-07 (수정) | US-07          | P0       |
| A4          | 세션 모니터링              | UC-08        | US-08          | P1       |
| A5          | 관리자 로그아웃            | UC-05 (종료) | -              | P0       |

---

## 6. 화면 전환 다이어그램

### 6.1 플레이어 화면 전환 플로우


### 6.2 관리자 화면 전환 플로우


---

## 7. 디바이스별 UX 고려사항

### 7.1 모바일 (스마트폰, 5~6인치 화면)

#### 레이아웃 조정

- **세로 모드 우선**: 모든 화면이 세로 방향 최적화
- **한 손 조작**: 주요 버튼은 화면 하단 배치
- **큰 터치 영역**: 최소 44x44px, 버튼 간 여백 16px 이상

#### 입력 방식

- **화상 키보드**: 힌트 코드 입력 시 자동으로 키보드 포커스
- **자동 완성 OFF**: 힌트 코드는 자동 완성 비활성화
- **진동 피드백**: 버튼 터치 시 햅틱 피드백 제공

#### 성능 최적화

- **이미지 최소화**: 아이콘은 SVG 사용
- **애니메이션 제한**: 부드러운 전환만 사용, 복잡한 애니메이션 지양
- **오프라인 캐싱**: Service Worker로 앱 쉘 캐싱

---

### 7.2 태블릿 (10인치 이상)

#### 레이아웃 조정

- **가로/세로 모드 모두 지원**
- **2단 레이아웃**: 힌트 내용 + 정답을 좌우 배치 가능
- **더 큰 글자**: 본문 20px, 제목 28px (모바일보다 +2px)

#### 관리자 화면 최적화

- **테이블 뷰**: 관리자 화면은 태블릿에서 더 편리
- **드래그앤드롭**: 힌트 순서 조정 시 마우스/터치 모두 지원

---

### 7.3 PC (데스크톱, 노트북)

#### 레이아웃 조정

- **넓은 화면 활용**: 최대 너비 1200px, 중앙 정렬
- **키보드 단축키**:
  - Enter: 힌트 제출
  - Esc: 모달 닫기
  - Tab: 폼 필드 간 이동
- **마우스 호버 효과**: 버튼, 링크에 hover 상태 표시

#### 관리자 화면 최적화

- **좌우 분할**: 네비게이션(좌) + 컨텐츠(우)
- **테이블 정렬**: 컬럼 헤더 클릭으로 정렬 가능
- **다중 선택**: Ctrl+클릭으로 여러 힌트 선택 후 일괄 작업

---

## 8. 다크 모드 vs 라이트 모드 시나리오

### 8.1 플레이어 화면 (기본: 다크 모드)

**이유**: 어두운 방에서 눈부심 방지 및 게임 몰입도 유지

#### 다크 모드 (기본)

- **배경**: #1a1a1a (거의 검정)
- **텍스트**: #ffffff (흰색)
- **강조 색상**: #4A90E2 (파란색)
- **타이머**: #FF6B6B (빨간색)

#### 라이트 모드 (선택)

- **배경**: #ffffff (흰색)
- **텍스트**: #333333 (진한 회색)
- **강조 색상**: #2563eb (파란색)
- **타이머**: #dc2626 (빨간색)

#### 전환 방법

- 화면 우측 상단에 작은 토글 스위치 (🌙 / ☀️)
- 설정은 localStorage에 저장 (다음 방문 시 유지)

---

### 8.2 관리자 화면 (기본: 라이트 모드)

**이유**: 밝은 사무실에서 작업하므로 라이트 모드가 더 편리

#### 라이트 모드 (기본)

- **배경**: #f9fafb (연한 회색)
- **카드**: #ffffff (흰색)
- **네비게이션**: #111827 (진한 회색)

#### 다크 모드 (선택)

- **배경**: #111827 (진한 회색)
- **카드**: #1f2937 (회색)
- **네비게이션**: #000000 (검정)

---

## 9. 접근성 (Accessibility) 고려사항

### 9.1 시각 장애 (MVP에서는 미지원, 2차 버전 검토)

- **스크린 리더**: ARIA 라벨 추가 (2차 버전)
- **고대비 모드**: WCAG AA 기준 (4.5:1 이상) 준수 (MVP 포함)
- **폰트 크기 조정**: 브라우저 기본 설정 존중

### 9.2 청각 장애

- **소리 없음**: 모든 알림은 시각적으로만 표시
- **진동 피드백**: 모바일에서 햅틱 피드백 제공

### 9.3 운동 장애

- **큰 터치 영역**: 최소 44x44px (WCAG 기준)
- **키보드 접근성**: 모든 기능 키보드로 조작 가능
- **시간 제한 없음**: 입력 시간 제한 없음 (타이머는 게임용)

---

## 10. 성능 시나리오

### 10.1 느린 네트워크 환경 (3G)

**상황**: 카페 Wi-Fi가 불안정하여 3G 수준의 속도

**처리 방법**:

- **초기 로딩**:
  - 중요 리소스 우선 로드 (HTML, CSS, JS)
  - 이미지는 레이지 로딩
  - 로딩 스피너 표시 (3초 이상 걸릴 경우)
- **힌트 조회**:
  - API 요청 타임아웃 10초 설정
  - 타임아웃 시 재시도 버튼 제공
  - 로컬 캐시 활용 (세션 시작 시 전체 힌트 다운로드)

---

### 10.2 동시 접속 20명

**상황**: 대형 카페에서 주말 성수기에 20개 세션 동시 진행

**처리 방법**:

- **서버 최적화**:
  - 데이터베이스 인덱싱 (themeId, hintCode)
  - API 응답 캐싱 (Redis, 2차 버전)
  - 서버리스 함수 자동 스케일링 (Vercel)
- **클라이언트 최적화**:
  - 불필요한 API 호출 최소화
  - 타이머는 클라이언트에서만 작동
  - 60초마다만 서버와 동기화

---

## 11. 보안 시나리오

### 11.1 관리자 비밀번호 유출

**상황**: 관리자 비밀번호가 SNS에 유출됨

**처리 방법**:

- **즉시 대응**:
  - 관리자 비밀번호 즉시 변경
  - 모든 JWT 토큰 무효화
  - 의심스러운 로그인 시도 로그 확인
- **장기 대책**:
  - 2FA (2단계 인증) 도입 검토 (2차 버전)
  - IP 화이트리스트 설정 (카페 내부 IP만 허용)

---

### 11.2 힌트 코드 SNS 공유

**상황**: 플레이어가 힌트 코드를 SNS에 공유하여 다른 고객이 미리 알게 됨

**처리 방법**:

- **수용**: 방탈출 특성상 힌트 공유는 일반적이므로 막지 않음
- **대안**:
  - 힌트 코드를 주기적으로 변경 (월 1회)
  - 테마별로 다른 코드 체계 사용
  - 동적 코드 생성 검토 (2차 버전)

---

## 12. 문서 변경 이력

| 버전 | 날짜       | 작성자          | 변경 내용                                 | 승인자 |
| ---- | ---------- | --------------- | ----------------------------------------- | ------ |
| 1.0  | 2025-11-26 | Product Manager | 초안 작성 (플레이어/관리자 시나리오 전체) | 윤인수 |
| 1.1  | 2025-11-27 | Product Manager | 와이어프레임 제거 및 실제 구현 반영<br>- API 엔드포인트 정확히 수정<br>- 관리자 로그인 방식 변경 (로고 5회 클릭 → /admin/login 직접 접속)<br>- JWT 저장 방식 명시 (localStorage) | 윤인수 |

---

## 문서 승인

본 문서는 EscapeHint 프로젝트의 공식 User Scenario Document로, 개발팀과 디자인팀이 참고할 수 있도록 실제 사용자 경험을 상세히 기술하였습니다.

**승인자**: 윤인수
**승인일**: 2025-11-27
**문서 상태**: 최종 승인 완료 (v1.1 - 실제 구현 반영)

---

**다음 단계**:

1. **전체 기능 테스트**: 모든 플레이어 및 관리자 시나리오 테스트
2. **버그 수정**: 테스트 중 발견된 이슈 해결
3. **성능 최적화**: API 응답 속도 및 프론트엔드 렌더링 최적화
4. **배포 준비**: Production 환경 설정 및 최종 배포

---

**문서 끝**
